LightDM (Русский)
Ссылки по теме
* Экранный менеджер
* GDM
* KDM (Русский)
* LXDM
Эта страница нуждается в сопроводителе
Статья не гарантирует актуальность информации. Помогите русскоязычному сообществу поддержкой подобных страниц. См. Команда переводчиков ArchWiki
Состояние перевода: На этой странице представлен перевод статьи LightDM. Дата последней синхронизации: 29 марта 2016. Вы можете помочь синхронизировать перевод, если в английской версии произошли изменения.
LightDM это кросс-десктопный Экранный менеджер. Главные особенности:
* Кросс-десктопный - поддерживает различные технологии рабочего стола.
* Поддерживает различные технологии отображения (X, Wayland, Mir, ...).
* Легковесный - низкое потребление памяти и высокая производительность.
* Поддержка гостевых сессий.
* Поддержка удаленного входа (входящий - XDMCP, VNC, исходящие - XDMCP, подключаемые).
* Комплексный набор тестов.
* Низкая сложность кода.
Более подробную информацию о проекте LightDM можно найти здесь.
Contents
 [hide] 
* 1Установка
o 1.1Greeter (Экран приветствия/входа в систему)
* 2Включение LightDM
* 3Инструмент командной строки
* 4Тестирование
* 5Дополнительные настройки и твики
o 5.1Изменение фонового изображения/цветов
* 5.1.1Экран приветствия GTK+
* 5.1.2Экран приветствия Unity
* 5.1.3Экран приветствия KDE
o 5.2Изменение вашего аватара
o 5.3Внедрение Arch-ориентированных 64x64 иконок
o 5.4Включение автовхода
o 5.5Включение интерактивного без парольного входа в систему
o 5.6Скрытие пользователей системы и служб
o 5.7Миграция с SLiM
o 5.8NumLock включен по умолчанию
o 5.9Переключение пользователя при Xfce4
o 5.10Сессия по умолчанию
o 5.11Регулировка положения входа окна
* 5.11.1Экран приветствия GTK+
* 6Решение проблем
o 6.1Локаль неправильно отображается
o 6.2Ресурсы X не корректно распознаны
o 6.3Отсутствуют иконки в Экране приветствия GTK
o 6.4LightDM зависает при попытке входа в систему
o 6.5LightDM отображается в неправильном мониторе
o 6.6LightDM не отображается
o 6.7Pulseaudio не запускается автоматически
* 7Смотрите также
Установка
Установите lightdm. Обратите внимание, что чётные выпуски являются стабильными (1.8, 1.10), а разрабатываемые релизы, - нечётными (1.9, 1.11). Разрабатываемые релизы доступны в lightdm-develAUR. Также доступен lightdm-bzrAUR.
Greeter (Экран приветствия/входа в систему)
Возможно вы хотите установить Экран приветствия. Экран приветствия представляет собой графический интерфейс, который предлагает пользователю ввести учетные данные, выбрать сеанс, и так далее. Можно использовать LightDM без Экрана приветствия, но только если он настроен на автоматический вход в систему. Ссылка на Экран приветствия lightdm-gtk-greeter. LightDM пытается использовать этот Экран приветствия при запуске, если он не настроен иначе.
Официальные репозитории содержат следующие альтернативные Экраны приветствия.
* lightdm-kde-greeter: Гритер использующий KDE4.
* lightdm-deepin-greeter (deepin-session-ui): Экран приветствия из проекта Deepin.
Другие альтернативные Экраны приветствия доступны в AUR.
* lightdm-webkit2-greeterAUR: Экран приветствия, который использует Webkit2 для тем. Он заменяет lightdm-webkit-greeterAUR.
* lightdm-unity-greeterAUR: Экран приветствия использующийся в Ubuntu Unity.
* lightdm-pantheon-greeterAUR: Экран приветствия из проекта elementary OS.
Вы можете установить Экран приветствия по умолчанию, путём изменения раздела [Seat:*] в файле настроек LightDM, например:
/etc/lightdm/lightdm.conf
[Seat:*]
...
greeter-session=lightdm-yourgreeter-greeter
Какие Экраны приветствия доступны? Какие значения можно назначить опцией greeter-session? Каждый файл .desktop в каталоге /usr/share/xgreeters обозначает доступный Экран приветствия. В этом примере доступны Экраны приветствия lightdm-gtk-greeter и lightdm-kde-greeter:
$ ls -1 /usr/share/xgreeters/
lightdm-gtk-greeter.desktop
lightdm-kde-greeter.desktop
Включение LightDM
Убедитесь в том что вы включили lightdm.service чтобы LightDM запускался при загрузке. Смотрите также Экранный менеджер#Запуск экранного менеджера.
Инструмент командной строки
LightDM предлагает инструмент командной строки, dm-tool, который может быть использован для блокировки текущего места, переключения сеансов и т.д., что полезно в «минималистских» оконных менеджерах и для тестирования. Чтобы увидеть список доступных команд, выполните следующую команду:
$ dm-tool --help
Тестирование
Вопервых, установите xorg-server-xephyr из официальных репозиториев.
Затем запустите LightDM как приложение X:
$ lightdm --test-mode --debug
Дополнительные настройки и твики
Некоторые Экраны приветствия имеют свои собственные файлы настроек. Например lightdm-gtk-greeter имеет:
/etc/lightdm/lightdm-gtk-greeter.conf
и lightdm-kde-greeter имеет:
/etc/lightdm/lightdm-kde-greeter.conf
а также раздел в системных настройках KDE (рекомендуется).
LightDM может быть настроен путём изменения его скрипта настроек /etc/lightdm/lightdm.conf.
Изменение фонового изображения/цветов
Пользователи, желающие иметь плоский цвет (без изображения) могут установить шестнадцатеричное значение background цвета.
Пример:
background=#000000
Если вы хотите вместо этого использовать изображение, смотрите ниже.
Экран приветствия GTK+
Можете воспользоваться программой с графическим интерфейсом lightdm-gtk-greeter-settings.
Пользователям, желающим настроить обои на экране приветствия необходимо отредактировать /etc/lightdm/lightdm-gtk-greeter.conf и определить переменную background под секцией [greeter]. Например:
/etc/lightdm/lightdm-gtk-greeter.conf
[greeter]
background=/usr/share/pixmaps/black_and_white_photography-wallpaper-1920x1080.jpg
Примечание: Рекомендуется поместить PNG или JPG-файл в /usr/share/pixmaps т.к. пользователю LightDM нужен доступ на чтение файла обоев рабочего стола.
Экран приветствия Unity
Пользователи, использующие lightdm-unity-greeterAUR должны отредактировать /usr/share/glib-2.0/schemas/com.canonical.unity-greeter.gschema.xml файл, а затем выполнить:
# glib-compile-schemas /usr/share/glib-2.0/schemas/
В соответствии с этой страницей.
Экран приветствия KDE
Зайдите в System Settings > Login Screen (LightDM) и измените фоновое изображение для вашей темы.
Как вариант, можете отредактировать переменную Background в lightdm-kde-greeter.conf :
/etc/lightdm/lightdm-kde-greeter.conf
[greeter]
theme-name=classic

[greeter-settings]
Background=/usr/share/archlinux/wallpaper/archlinux-underground.jpg
BackgroundKeepAspectRatio=true
GreetMessage=Welcome to %hostname%
Изменение вашего аватара
Совет: Если вы используете KDE, вы можете изменить свой аватар в Системных Настройках KDE.
Во-первых, убедитесь, что пакет accountsservice из Официальных репозиториев установлен, затем установите его следующим образом, заменив username на регистрационное имя нужного пользователя. Расширение файла .png не должно содержатся в имени файла.
* Отредактируйте или создайте файл /var/lib/AccountsService/users/username, и добавьте строки
[User]
Icon=/var/lib/AccountsService/icons/username
* Создайте файл /var/lib/AccountsService/icons/username используя файл изображения 96x96 PNG.
Примечание: Убедитесь, что оба созданных файлы имеют права 644, используйте Chmod, чтобы исправить права, при необходимости.
Внедрение Arch-ориентированных 64x64 иконок
Пакет archlinux-artworkAUR из AUR содержит некоторые интересные примеры, которые устанавливаются в /usr/share/archlinux/icons и которые могут быть скопированы в /usr/share/icons/hicolor/64x64/devices следующим образом:
# find /usr/share/archlinux/icons -name "*64*" -exec cp {} /usr/share/icons/hicolor/64x64/devices \;
После копирования, пакет archlinux-artworkAUR может быть удалён.
Включение автовхода
Отредактируйте файл настроек LightDM, расскомментируйте эти строки и правильно настройте:
/etc/lightdm/lightdm.conf
[Seat:*]
pam-service=lightdm
pam-autologin-service=lightdm-autologin
autologin-user=username
autologin-user-timeout=0
session-wrapper=/etc/lightdm/Xsession
LightDM проходит через PAM даже когда включен autologin. Вы должны быть в группе autologin чтобы входить в систему автоматически без вода пароля:
# groupadd -r autologin
# gpasswd -a username autologin
Примечание: Пользователи GNOME, использующие расширение gnome-keyring должны установить пустой пароль для своего gnome-keyring, чтобы он разблокировался автоматически.
Включение интерактивного без парольного входа в систему
LightDM проходит через PAM, так что вы должны сконфигурировать lightdm настройки PAM:
/etc/pam.d/lightdm
#%PAM-1.0
auth        sufficient  pam_succeed_if.so user ingroup nopasswdlogin
auth        include     system-login
...
Вы также должны входить в группу nopasswdlogin чтобы получить возможность входа в систему в интерактивном режиме без ввода пароля:
# groupadd -r nopasswdlogin
# gpasswd -a username nopasswdlogin
Примечание: Пользователям GNOME, и пользователям Gnome-keyring, возможно, придётся следовать инструкциям в конце предыдущего раздела о включении автоматического логина.
Для того, чтобы создать новую учетную запись пользователя, которая входит в систему автоматически и дополнительно имеет возможность снова войти в систему без пароля, пользователь может быть создан с помощью дополнительного участия в обеих группах и т.д .:
# useradd -mG autologin,nopasswdlogin -s /bin/bash username
Скрытие пользователей системы и служб
Чтобы запретить системным пользователям отображаться в начале при входе в систему, установите дополнительную зависимость accountsservice, или добавьте имя пользователя в /etc/lightdm/users.conf под hidden-users. Первый вариант предпочтительнее, - не нужно будет обновлять список при многократном добавлении или удалении пользователей.
Миграция с SLiM
Переместите содержимое xinitrc в xprofile, удалите вызов запуска Оконного менеджера или Среды рабочего стола.
Также удалите содержимое ~/.dmrc, и выберите на иконке Сессий (в правом верхнем углу экрана по умолчанию), сессию которую вы хотите запустить.
NumLock включен по умолчанию
Установите пакет numlockx и отредактируйте /etc/lightdm/lightdm.conf добавив следующие строки:
greeter-setup-script=/usr/bin/numlockx on
Переключение пользователя при Xfce4
Если вы используете рабочий стол Xfce, то кнопка действия Функции Переключения Пользователей ищет в вашем Запуске Приложений специальный исполняемый файл gdmflexiserver, для того чтобы задействовать себя. Если вы предоставите исполняемый сценарий оболочки /usr/bin/gdmflexiserver состоящий из
#!/bin/sh
/usr/bin/dm-tool switch-to-greeter
то переключение пользователей в Xfce должно работать с LightDM.
В качестве альтернативы, если вы используете меню Whisker, пройдите Properties -> Commands и измените команду "Switch Users" непосредственно на:
 dm-tool switch-to-greeter
Кроме того, можно переключать пользователей с экрана блокировки XScreenSaver, - смотрите XScreenSaver#LightDM.
Сессия по умолчанию
Lightdm, как и другие Экранные менеджеры, хранит последнюю выбранную xsession в ~/.dmrc. Для подробностей смотрите Экранный менеджер#Список сеансов.
Регулировка положения входа окна
Экран приветствия GTK+
Пользователям нужно отредактировать /etc/lightdm/lightdm-gtk-greeter.conf и ввести значение в переменную position. Оно принимает значения x и y, абсолютные (в пикселях) или относительные (в процентах). Каждое значение может иметь дополнительное местоположение для привязки окна, start, center и end. Значения отделяются запятой.
Пример:
position=200,start 50%,center
Решение проблем
Если вы столкнулись с миганием экрана, и в итоге LightDM не запускается, проверьте что вы определили Экран приветствия правильно, в файле настроек LightDM. И если вы правильно задали Экран приветствия GTK, убедитесь что xsessions-directory (по умолчанию: /usr/share/xsessions) существует и содержит по меньшей мере один файл .desktop.
Та же ошибка может произойти при запуске Lightdm, когда последняя запускаемая сессия больше не доступна (например, когда вы последний раз использовали Gnome, а потом удалили пакет gnome-session): самый простой способ, - временно восстановить удалённый пакет. Другое решение:
# dbus-send --system --type=method_call --print-reply --dest=org.freedesktop.Accounts /org/freedesktop/Accounts/User1000 org.freedesktop.Accounts.User.SetXSession string:xfce
В этом примере устанавливается сессия по умолчанию "xfce" для пользователя 1000.
Локаль неправильно отображается
Если ваша локаль не отображается правильно LightDM, добавьте свой языковой стандарт в /etc/environment
 LANG=ru_RU.utf8
Ресурсы X не корректно распознаны
В LightDM есть ошибка при которой ваш файл Xresources не будет загружен на предварительную обработку. В практическом плане это означает, что набор переменных #define не определится при последующих вызовах. Вы можете увидеть как экран отображается розовым цветом, при использовании пользовательского набора цветов в urxvt. Чтобы исправить это, отредактируйте /etc/lightdm/Xsession и найдите эту строку:
xrdb -nocpp -merge "$file"
Измените её для чтения:
xrdb -merge "$file"
Теперь ваш Xresources будет предварительно обработан таким образом, чтобы переменные правильно определялись.
Отсутствуют иконки в Экране приветствия GTK
Если вы используете lightdm-gtk-greeter как Экран приветствия и видите "заполнитель изображений" в виде иконок, убедитесь что действующая тема значков установлена и задействована. Проверьте следующий файл:
/etc/lightdm/lightdm-gtk-greeter.conf
[greeter]
theme-name=mate      # this should be the name of a directory under /usr/share/themes/
icon-theme-name=mate # this should be the name of a fully featured icons set directory under /usr/share/icons/
LightDM зависает при попытке входа в систему
После ввода правильного имени пользователя и пароля, при попытке войти в систему, вы обнаруживаете что LightDM завис и вы не можете продолжить загрузу до Рабочего стола. Чтобы устранить эту проблему, переустановите пакет gdk-pixbuf2. Смотрите эту тему на форуме (Англ.).
LightDM отображается в неправильном мониторе
Если вы используете несколько мониторов, LightDM может отображаться в неправильном (например, если ваш основной монитор находится справа). Чтобы заставить экран LightDM отображаться на конкретном мониторе, отредактируйте /etc/lightdm/lightdm.conf и измените display-setup-script параметр, например:
/etc/lightdm/lightdm.conf
display-setup-script=xrandr --output HDMI1 --primary
Замените HDMI1 на ваш настоящий ID монитора, который можно найти с помощью результата вывода команды xrandr.
LightDM не отображается
Может случиться так, что ваша система загружается так быстро, что служба LightDM запускается перед загрузкой вашего графического драйвера. Если это ваш случай, добавьте следующие настройки в ваш файл lightdm.conf:
   [LightDM]
   logind-check-graphical=true
Этот параметр прикажет LightDM ждать, пока графический драйвер не будет готов перед запуском сессии Экранного приветствия/автозапуска.
Pulseaudio не запускается автоматически
Смотрите PulseAudio (Русский)#Выполнение.
